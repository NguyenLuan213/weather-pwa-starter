<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Weather PWA</title>
  <meta name="description" content="Ứng dụng thời tiết dạng PWA: xem thời tiết hiện tại và dự báo ngắn hạn, hoạt động offline." />
  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#0ea5e9" />
  <link rel="icon" href="icons/icon-192.png" sizes="192x192" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
  <link rel="stylesheet" href="css/styles.css" />
</head>
<body>
  <header class="appbar">
    <h1>Weather PWA</h1>
    <button id="installBtn" class="btn" type="button" hidden>Cài đặt</button>
  </header>

  <main class="container">
    <section class="controls card">
      <div class="row">
        <label for="city">Thành phố</label>
        <input id="city" placeholder="VD: Đà Nẵng" autocomplete="off" />
      </div>
      <input id="apiKey" type="hidden" value="dd65b83e119e689a2311bdfdb435371f" />
      <div class="row">
        <button id="useLocation" class="btn" type="button">Dùng vị trí hiện tại</button>
        <button id="refresh" class="btn" type="button">Lấy dữ liệu</button>
      </div>
      <p class="hint">Bạn chỉ cần nhập tên thành phố hoặc dùng vị trí hiện tại.</p>
    </section>

    <section id="status" class="status" role="status" aria-live="polite"></section>

    <section id="current" class="card current" aria-live="polite" role="button" tabindex="0" aria-label="Xem chi tiết thời tiết hiện tại">
      <h2>Hiện tại</h2>
      <div class="current-grid">
        <div class="big-temp"><span id="temp">--</span>&deg;C</div>
        <div class="meta">
          <div id="desc">&mdash;</div>
          <div>Độ ẩm: <span id="humidity">--</span>%</div>
          <div>Gió: <span id="wind">--</span> m/s</div>
          <div>Cập nhật: <span id="updated">&mdash;</span></div>
        </div>
        <div class="icon-wrap"><img id="icon" alt="" src="" loading="lazy" /></div>
      </div>
    </section>

    <section class="card">
      <div class="forecast-header">
        <h2>Dự báo</h2>
        <div id="forecastModes" class="forecast-modes" role="tablist" aria-label="Chế độ dự báo">
          <button type="button" class="mode-btn active" data-forecast-mode="hourly" aria-pressed="true">Theo giờ</button>
        </div>
      </div>
      <p id="forecastSummary" class="forecast-summary hint"></p>
      <div id="forecast" class="forecast" aria-live="polite"></div>
    </section>
  </main>

  <footer class="footer">PWA demo &middot; Hoạt động offline với cache thông minh</footer>

  <aside id="detailDialog" class="detail-dialog hidden" role="dialog" aria-modal="true" aria-labelledby="detailTitle" aria-hidden="true" tabindex="-1">
    <div class="detail-content">
      <button type="button" class="detail-close" aria-label="Đóng chi tiết">&times;</button>
      <h3 id="detailTitle" class="detail-title"></h3>
      <div id="detailBody" class="detail-body"></div>
    </div>
  </aside>
  <script type="module" src="js/app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker
          .register('./sw.js')
          .then((reg) => console.log('Service worker registered:', reg.scope))
          .catch((err) => console.warn('Service worker registration failed', err));
      });
    }
  </script>
</body>
</html>
